{%if settings.dgHomeLink === true%}
    <nav class="navbar">
        <div class="navbar-inner">
            <a href="/" style="text-decoration: none;">
                <h1 style="margin: 15px !important;">{{meta.siteName}}</h1>
            </a>
            <button onclick="goBack()" class="back-button">⬅ Torna Indietro</button>
            <script>
            function goBack() {
                sessionStorage.setItem("scrollPosition", window.scrollY);
                history.back(); // Torna alla pagina precedente
            }
            </script>
        </div>
        {% if settings.dgEnableSearch === true%}
            {% include "components/searchButton.njk" %}
        {%endif%}
    </nav>
{%else%}
    <div class="empty-navbar">
        {% if settings.dgEnableSearch === true%}
            {% include "components/searchButton.njk" %}
        {%endif%}
    </div>
{%endif%}




<script>
document.addEventListener("DOMContentLoaded", function () {
    // Salva la posizione dello scroll quando l'utente clicca su un link
    document.querySelectorAll("a").forEach(link => {
        link.addEventListener("click", function (event) {
            let scrollY = window.scrollY;
            let targetId = event.target.closest("a").id; // Prende l'ID del link cliccato
            sessionStorage.setItem("scrollPosition", scrollY);
            sessionStorage.setItem("lastClickedLink", targetId);
        });
    });

    // Quando la pagina si carica, controlla se c'è una posizione salvata
    if (sessionStorage.getItem("scrollPosition") !== null) {
        setTimeout(() => {
            let scrollToY = sessionStorage.getItem("scrollPosition");
            window.scrollTo({ top: scrollToY, behavior: "smooth" });
            sessionStorage.removeItem("scrollPosition"); // Rimuove la posizione dopo l'uso
        }, 200); // Ritarda lo scroll per assicurarsi che tutti gli elementi siano caricati
    }
});

// Funzione per tornare indietro e scorrere al punto esatto
function goBack() {
    sessionStorage.setItem("scrollPosition", window.scrollY);
    history.back(); // Torna alla pagina precedente
}

// Miglioramento: Assegna automaticamente un ID ai link senza ID per poterli tracciare
document.querySelectorAll("a:not([id])").forEach((link, index) => {
    link.id = "auto-link-" + index;
});
</script>

