---
{"dg-publish": true, "permalink": "/credit-risk-site/Variabile-casuale-somma/"}
---





La **variabile casuale somma**, come dice lo stesso nome, si ottiene sommando più variabili casuali.

La distribuzione della somma di v.c. può ottenersi in diversi modi:

- **Meodo analitico**: Ci si mette carta e penna e cerca di *dimostrare matematicamente* come si distribuisce la somma facendo dei passaggi algebrici. 
Abbiamo per esempio visto il caso in cui la somma di due Poisson è una Poisson, somma di due normali indipendenti è una normale. Nella maggior parte dei casi della vita reale non è possibile arrivare a conclusioni utili in questo modo. Inoltre questo metodo richiede l'indipendenza tra variabili

- **Metodo della funzione generatrice delle probabilità**: Come visto anche in precedenza quando abbiamo calcolato la distribuzione di una combinazione lineare di Poisson con questo approccio usiamo la FGP per generare la distribuzione di probabilità della somma. Tuttavia nella vita reale è di difficile utilizzo in quanto è utilizzabile solo su variabili con supporto composto da numeri naturali, o anche per difficoltà nel calcolo delle derivate della FGP.

- **Metodo approssimazioni asintotiche**: Abbiamo visto questo esempio studiando il [[Credit Risk _site/permalink/Teorema del limite centrale\|Teorema del limite centrale]], esso infatti coinvolge la somma di variabili casuali quando esse sono in numero molto elevato. Il limite di questo approccio è il fatto di dover avere molte variabili e alcuni criteri stringenti. Possiamo invece tralasciare l'indipendenza e l'essere identicamente distribuite.

- **Metodo costruttivo**: Applicabile nel caso di distribuzioni *discrete multivariate*. Il limite di tale approccio è il suo “costo computazionale”, abbimo i supporti che diventano enormi se dobbiamo gestire un gran numero di variabili.

- **Metodo Montecarlo**: 

## *Metodo costruttivo*
Vediamo il metodo passo passo
La somma di variabile casuale ha come **supporto potenziale** tutte le possibili *somme dei supporti* delle singole variabili casuali.
<style> .container {font-family: sans-serif; text-align: center;} .button-wrapper button {z-index: 1;height: 40px; width: 100px; margin: 10px;padding: 5px;} .excalidraw .App-menu_top .buttonList { display: flex;} .excalidraw-wrapper { height: 800px; margin: 50px; position: relative;} :root[dir="ltr"] .excalidraw .layer-ui__wrapper .zen-mode-transition.App-menu_bottom--transition-left {transform: none;} </style><script src="https://cdn.jsdelivr.net/npm/react@17/umd/react.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react-dom@17/umd/react-dom.production.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@excalidraw/excalidraw@0/dist/excalidraw.production.min.js"></script><div id="Variabile_casuale_somma_2023-04-23_1811.15.excalidraw.md1"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"tXYiVW-BLrSTUIhIL0V2m","type":"image","x":-346.8298568725586,"y":-193.00691986083984,"width":693,"height":309,"angle":0,"strokeColor":"transparent","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":2016879112,"version":14,"versionNonce":1604896120,"isDeleted":false,"boundElements":[{"id":"U8SSi727-ZsYVbEwki3p7","type":"arrow"}],"updated":1682266318791,"link":null,"locked":false,"status":"pending","fileId":"e6865859e5e0af45e2f7189dda2051f8d39ad681","scale":[1,1]},{"id":"n5WdD9EunVNrwI7ocpXVU","type":"arrow","x":-140.87035369873053,"y":-231.8861821492514,"width":6.816121419270871,"height":166.50764973958337,"angle":0,"strokeColor":"#364fc7","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":776469512,"version":44,"versionNonce":195538696,"isDeleted":false,"boundElements":null,"updated":1682266313633,"link":null,"locked":false,"points":[[0,0],[6.816121419270871,166.50764973958337]],"lastCommittedPoint":null,"startBinding":{"elementId":"ijtt1fHk","focus":0.31172508689782324,"gap":12.243183289841738},"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow"},{"id":"ijtt1fHk","type":"text","x":-216.89393372233405,"y":-264.0057746565065,"width":219,"height":20,"angle":0,"strokeColor":"#364fc7","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":2050210936,"version":84,"versionNonce":493958776,"isDeleted":false,"boundElements":[{"id":"n5WdD9EunVNrwI7ocpXVU","type":"arrow"}],"updated":1682266313634,"link":null,"locked":false,"text":"Somma del supporto 0.3 + 1","rawText":"Somma del supporto 0.3 + 1","fontSize":15.9011273739307,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":14,"containerId":null,"originalText":"Somma del supporto 0.3 + 1"},{"type":"arrow","version":99,"versionNonce":172068616,"isDeleted":false,"id":"U8SSi727-ZsYVbEwki3p7","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-106.47066540043627,"y":117.71884250829827,"strokeColor":"#364fc7","backgroundColor":"transparent","width":90.9893429502913,"height":50.147026745778064,"seed":536061816,"groupIds":[],"roundness":{"type":2},"boundElements":null,"updated":1682266318791,"link":null,"locked":false,"startBinding":{"elementId":"tXYiVW-BLrSTUIhIL0V2m","focus":0.282887655961077,"gap":1.725762369138124},"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[90.9893429502913,-50.147026745778064]]},{"type":"text","version":117,"versionNonce":384575608,"isDeleted":false,"id":"PrJx9v2d","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-187.55214719058506,"y":125.53256825765561,"strokeColor":"#364fc7","backgroundColor":"transparent","width":234,"height":20,"seed":1918981752,"groupIds":[],"roundness":null,"boundElements":null,"updated":1682266334125,"link":null,"locked":false,"fontSize":15.9011273739307,"fontFamily":1,"text":"Somma del supporto 4.8 + 1.5","rawText":"Somma del supporto 4.8 + 1.5","baseline":14,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Somma del supporto 4.8 + 1.5"}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#364fc7","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":730.5796230036038,"scrollY":303.25158906600836,"zoom":{"value":0.9977528279972994},"currentItemRoundness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Variabile_casuale_somma_2023-04-23_1811.15.excalidraw.md1");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>
Ovviamente se nella tabella iniziale due supporti hanno come probabilità 0 di avvenire contemporaneamente ciò fa sì che la loro somma non possa avvenire.
<div id="Variabile_casuale_somma_2023-04-23_1818.10.excalidraw.md2"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"ZatfayZCuVDhxOnHHm1Iz","type":"image","x":-346.3644027709961,"y":-120.57781219482422,"width":751,"height":232,"angle":0,"strokeColor":"transparent","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":614865416,"version":14,"versionNonce":946942728,"isDeleted":false,"boundElements":null,"updated":1682266692906,"link":null,"locked":false,"status":"pending","fileId":"ad91f28661cfee31991c37c060e35bbe689c72ef","scale":[1,1]},{"id":"P-mr97DAxIPDPTMFr-FOP","type":"ellipse","x":84.97684478759766,"y":-86.18071746826172,"width":78.8720703125,"height":45.27838134765625,"angle":0,"strokeColor":"#c92a2a","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":4,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":682975608,"version":37,"versionNonce":545485688,"isDeleted":false,"boundElements":null,"updated":1682266702303,"link":null,"locked":false},{"id":"EHZ6gFzc","type":"text","x":-133.3818588256836,"y":-225.90386199951172,"width":458,"height":99,"angle":0,"strokeColor":"#c92a2a","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":4,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":842637320,"version":250,"versionNonce":1662513528,"isDeleted":false,"boundElements":null,"updated":1682266745108,"link":null,"locked":false,"text":"Il supporto 2.3 dato dalla somma\ndi 0.3 e 2 non è realizzabile in quanto\nle due variabili hanno probabilità\n0 di assumere contemporaneamente quei valori","rawText":"Il supporto 2.3 dato dalla somma\ndi 0.3 e 2 non è realizzabile in quanto\nle due variabili hanno probabilità\n0 di assumere contemporaneamente quei valori","fontSize":20,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":92,"containerId":null,"originalText":"Il supporto 2.3 dato dalla somma\ndi 0.3 e 2 non è realizzabile in quanto\nle due variabili hanno probabilità\n0 di assumere contemporaneamente quei valori"}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#c92a2a","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":4,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":667.0918579101562,"scrollY":312.6297607421875,"zoom":{"value":1},"currentItemRoundness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Variabile_casuale_somma_2023-04-23_1818.10.excalidraw.md2");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

Avendo i supporti potenziali possiamo organizzarli tutti in una **tabella univariata**, semplicemente al nuovi supporti *associamo la probabilità* che i due supporti si verifichino contemporaneamente.
<div id="Variabile_casuale_somma_2023-04-23_1825.32.excalidraw.md3"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"n3kuerz7_E2QgEc8BIwm7","type":"image","x":218.31526914555974,"y":-104.98106934920594,"width":164.18582218251328,"height":436.16320588485047,"angle":0,"strokeColor":"transparent","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":1874067976,"version":131,"versionNonce":1785905016,"isDeleted":false,"boundElements":[{"id":"-qqGoiYoTjpj_YV1MKyNy","type":"arrow"}],"updated":1682267190616,"link":null,"locked":false,"status":"pending","fileId":"2b13e7f1ff6fadfb31ea8edea683676c9fe7dfb9","scale":[1,1]},{"id":"TLunWKE82c98ZiJTV1pVV","type":"image","x":-352.3224198016204,"y":-119.57781219482422,"width":500.4851258581236,"height":312,"angle":0,"strokeColor":"transparent","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":1255280248,"version":5,"versionNonce":984945672,"isDeleted":false,"boundElements":null,"updated":1682267190616,"link":null,"locked":false,"status":"pending","fileId":"a629f0a6d8fbc6afe5eb0c4d7c9cf2fcab5d9427","scale":[1,1]},{"id":"-wwnX4FN6N9u91H2GgXsq","type":"arrow","x":-150.90901947021484,"y":-72.3050765991211,"width":434.52655029296875,"height":66.45703125,"angle":0,"strokeColor":"#364fc7","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1819952760,"version":286,"versionNonce":1172050040,"isDeleted":false,"boundElements":null,"updated":1682267190616,"link":null,"locked":false,"points":[[0,0],[273.13104248046875,-66.45703125],[434.52655029296875,-4.38177490234375]],"lastCommittedPoint":[434.52655029296875,-4.38177490234375],"startBinding":null,"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow"},{"id":"-qqGoiYoTjpj_YV1MKyNy","type":"arrow","x":-158.2119369506836,"y":97.12378692626953,"width":672.6033935546875,"height":237.346435546875,"angle":0,"strokeColor":"#2b8a3e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1806757384,"version":226,"versionNonce":570774280,"isDeleted":false,"boundElements":null,"updated":1682267190616,"link":null,"locked":false,"points":[[0,0],[355.65447998046875,74.490234375],[672.6033935546875,-134.3746337890625],[553.56494140625,-162.856201171875]],"lastCommittedPoint":[553.56494140625,-162.856201171875],"startBinding":null,"endBinding":{"elementId":"n3kuerz7_E2QgEc8BIwm7","focus":-0.8478330151835282,"gap":12.851913127493361},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"FXdlw7GW2RMJQOvh_o_mF","type":"rectangle","x":-191.8055648803711,"y":73.7542495727539,"width":48.9298095703125,"height":27.020965576171875,"angle":0,"strokeColor":"#2b8a3e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":1391833608,"version":30,"versionNonce":1601183864,"isDeleted":false,"boundElements":null,"updated":1682267193207,"link":null,"locked":false},{"id":"mXtkm9yQn_YDnIUNSLFYK","type":"rectangle","x":-185.96321868896484,"y":-75.22628021240234,"width":40.8966064453125,"height":24.09979248046875,"angle":0,"strokeColor":"#364fc7","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":1451577720,"version":21,"versionNonce":1063541624,"isDeleted":false,"boundElements":null,"updated":1682267199644,"link":null,"locked":false},{"id":"cg6s0uT-wH6pYv-ehfu26","type":"line","x":-188.8844223022461,"y":99.31464385986328,"width":41.62689208984375,"height":2.19085693359375,"angle":0,"strokeColor":"#2b8a3e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":716945272,"version":17,"versionNonce":1777549688,"isDeleted":true,"boundElements":null,"updated":1682267190617,"link":null,"locked":false,"points":[[0,0],[41.62689208984375,-2.19085693359375]],"lastCommittedPoint":null,"startBinding":null,"endBinding":null,"startArrowhead":null,"endArrowhead":null}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#364fc7","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":667.0918579101562,"scrollY":312.6297607421875,"zoom":{"value":1},"currentItemRoundness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Variabile_casuale_somma_2023-04-23_1825.32.excalidraw.md3");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>
Se dovesse capitare, ad esempio, che venga fuori lo **stesso supporto** 5.8 per più volte (generato da varie somme di supporti diversi) in questo caso basterà scriverlo una sola volta e sommare le probabilità che esca quel valore.

FOGLIO EXCEL: ![[Variabile casuale somma.xlsx]]

![[VC somma.mp4]]

---
La somma di variabili casuali si può fare anche su un **miscuglio**.
Vogliamo sapere come è la variabile casuale somma sul miscuglio di due variabili, per ottenerla abbiamo due modi:
- Partire dalle singole variabili, fare il miscuglio e poi sommare le variabili
- Sommare le singole variabili e poi fare il miscuglio della somma

> *Le operazioni di miscuglio e somma sono interscambiabili tra loro*, il risultato è sempre lo stesso.
> ![Pasted image 20230611123024.png](/img/user/Credit%20Risk%20_site/allegati/Pasted%20image%2020230611123024.png)

**Dimostrazione**
<div id="Variabile_casuale_somma_2023-06-11_1229.09.excalidraw.md4"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"type":"image","version":183,"versionNonce":1021888599,"isDeleted":false,"id":"ShS6MkvTCqmENTolRU-p_","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-316.37588463275563,"y":-125.49096651152115,"strokeColor":"transparent","backgroundColor":"transparent","width":411,"height":472,"seed":1234226583,"groupIds":[],"roundness":null,"boundElements":[],"updated":1686480011743,"link":null,"locked":false,"status":"pending","fileId":"2c4716cda275213987c7b93b3bb18a3fb0189e18","scale":[1,1]},{"id":"4FMaKBL6v3Xa2wyxy4TGs","type":"ellipse","x":-173.8162926615521,"y":123.11290428308601,"width":61.00799681414804,"height":31.650747249080098,"angle":0,"strokeColor":"#e67700","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1616163191,"version":49,"versionNonce":518208631,"isDeleted":false,"boundElements":null,"updated":1686479973099,"link":null,"locked":false},{"id":"mKtnZPKn","type":"text","x":-136.66107429728885,"y":86.59051995458752,"width":134.3522423466827,"height":21.25826619409537,"angle":0,"strokeColor":"#e67700","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":1007745463,"version":72,"versionNonce":1489025207,"isDeleted":false,"boundElements":null,"updated":1686480192767,"link":null,"locked":false,"text":"Y è un miscuglio e quindi questa\nprobabilità si può scrivere come","rawText":"Y è un miscuglio e quindi questa\nprobabilità si può scrivere come","fontSize":8.503306477638148,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":19.25826619409537,"containerId":null,"originalText":"Y è un miscuglio e quindi questa\nprobabilità si può scrivere come"},{"id":"CPo3IxAqVCkIAVJcE5QkT","type":"ellipse","x":-68.3137507155825,"y":108.89300778993723,"width":106.87856388282296,"height":69.72338385533666,"angle":0,"strokeColor":"#e67700","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":445571993,"version":74,"versionNonce":1899198487,"isDeleted":false,"boundElements":null,"updated":1686480025774,"link":null,"locked":false},{"id":"vIQmkH63sNvAwyxXPRs71","type":"ellipse","x":-219.22825603536705,"y":167.6823403087767,"width":35.32042021705354,"height":49.5402975418138,"angle":0,"strokeColor":"#a61e4d","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1717198135,"version":41,"versionNonce":1984740279,"isDeleted":false,"boundElements":null,"updated":1686480179155,"link":null,"locked":false},{"id":"ZJts3BZiix2RwHz0Oo3iS","type":"ellipse","x":-171.5227566407629,"y":170.89329457155918,"width":37.613898732677114,"height":59.63184069857528,"angle":0,"strokeColor":"#a61e4d","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1857503033,"version":74,"versionNonce":203375511,"isDeleted":false,"boundElements":null,"updated":1686480190672,"link":null,"locked":false},{"type":"text","version":139,"versionNonce":1651838169,"isDeleted":false,"id":"XvARMaUP","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-67.08697914895629,"y":179.51250132283712,"strokeColor":"#a61e4d","backgroundColor":"transparent","width":82,"height":10,"seed":458068537,"groupIds":[],"roundness":null,"boundElements":null,"updated":1686480202483,"link":null,"locked":false,"fontSize":8.503306477638148,"fontFamily":1,"text":"Inverto sommatorie","rawText":"Inverto sommatorie","baseline":7,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Inverto sommatorie"},{"id":"QdFOTr8Q","type":"text","x":138.2063069806234,"y":118.93762951843009,"width":11,"height":25,"angle":0,"strokeColor":"#e67700","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":559295097,"version":85,"versionNonce":1554228375,"isDeleted":true,"boundElements":null,"updated":1686480001070,"link":null,"locked":false,"text":"","rawText":"","fontSize":20,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":18,"containerId":"ShS6MkvTCqmENTolRU-p_","originalText":""}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#a61e4d","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":493.9074343532245,"scrollY":-39.96125441916048,"zoom":{"value":1.5920784433793722},"currentItemRoundness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Variabile_casuale_somma_2023-06-11_1229.09.excalidraw.md4");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

Se avessimo a che fare con 3 variabili composte rispettivamente da supporti di dimensioni 4, 3 e 3 il numero totale delle componenti del supporto della varibile somma sarebbe $4$ x $3$ x $3$ = $36$. 

Vediamo un esempio più complesso con **3 variabili** e l'utilizzo delle tabelle pivot
![[Variabile Somma e tabella pivot.mp4]]

## Metodo montecarlo
E' un metodo che si basa sulla [[Credit Risk _site/permalink/Concezione frequentista della probabilità\|Concezione frequentista della probabilità]].
Da qui deriva l'approccio Montecarlo, solo che invece di replicare fisicamente l'evento che ci interessa lo facciamo attraverso una simulazione dell'evento di interesse se conosciamo le sue caratteristiche.

Excel ci torna utile per generare numeri casuali da una determinata distribuzione di probabilità.
![[Generazione numeri casuali.mp4]]

Vediamo un esempio con la **somma di gamma-poisson** fruttando una simulazione montecarlo, noteremo che anche se questa variabile ha un supporto infinito in realtà le probabilità si concentrano all'inizio del supporto.
![[Somma di Gamma-poisson simulazione montecarlo.mp4]]
Da questo esempio notiamo anche che la probabilità della variabile somma cambia di molto se cambiamo la *struttura d'associazione* tra le variabili $X$ (ovvero se esse sono indipendenti, cograduate, contrograduate).

Il procedimento è quindi quello di:
1. Generare dei valori casuali
2. Farne la somma
3. Aggregarli con le tabelle pivot

![[Esempio montecarlo usando vc uniforme come generatrice.mp4]]
In questo esempio usiamo la VC uniforme per generare numeri casuali da una distribuzione qualsiasi, è il motore di tutto quando facciamo una simulazione montecarlo.
Lo si fa con la funzione =inv.

## *Somma di miscugli: Un esempio per il modello CreditRisk+*

Abbiamo 3 soggetti e la variabile casuale $X$ che rappresenta il caso di solvenza/insolvenza.
Di loro natura questa variabile è una [[Credit Risk _site/permalink/Variabile casuale indicatore (di Bernoulli)\|bernoulli]], che approssimiamo ad una Poisson come visto in precedenza nel corso.
Immaginiamo che il merito creditizio non sia costante ma può variare in base alla congiuntura economica, essa infatti influisce sulla probabilità di insolvenza dei soggetti.
Espansione: prob di default diminuisce
Recessione: prob di default aumenta
$\Theta$ è la variabile casuale che rappresenta la congiuntura economica.
Possiamo quindi immaginare che i parametri $\lambda$ siano legati tramite una funzione a $\Theta$.
La variabile $X$ possibilità di default è condizionata al fatto che lo scenario economico $\Theta$ risulti essere quel particolare scenario $\theta$.
Questa variabile $X$ si dstribuisce come una Poisson di parametro  $\lambda$ che dipende da $\theta$.
![Pasted image 20230429122540.png](/img/user/Credit%20Risk%20_site/allegati/Pasted%20image%2020230429122540.png)
Assumiamo che le variabili $X$ siano indipendenti tra di loro condizionatamente alla congiuntura economica.
Ciò a volte è plausibile, se magari abbiamo debitori di diversa area geografica e diversa occupazione.

> La probabilità di vedere contemporaneamente i 3 default è dato dal prodotto delle 3 probabilità.
> ![Pasted image 20230429123007.png](/img/user/Credit%20Risk%20_site/allegati/Pasted%20image%2020230429123007.png)

Se invece vogliamo guardare la probabilità congiunta di default ma NON CONDIZIONATA alla congiuntura economica devo fare il miscuglio.
<div id="Variabile_casuale_somma_2023-04-29_1234.00.excalidraw.md5"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"gKGHCQQSDL6HBQfkt6Xv1","type":"image","x":-221.15844870902396,"y":-158.21343231201172,"width":483.2432432432432,"height":312,"angle":0,"strokeColor":"transparent","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":147479589,"version":28,"versionNonce":22267749,"isDeleted":false,"boundElements":null,"updated":1682764443181,"link":null,"locked":false,"status":"pending","fileId":"0cbf4dc464ecf4835feeaa6c190d910a88464cca","scale":[1,1]},{"id":"Tgu6y91sT99OzGUXOG1Bw","type":"ellipse","x":103.9645767211914,"y":-136.5711898803711,"width":138.02606201171875,"height":92.01733398437501,"angle":0,"strokeColor":"#364fc7","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1144687979,"version":59,"versionNonce":550432811,"isDeleted":false,"boundElements":null,"updated":1682764456867,"link":null,"locked":false},{"id":"-CdfGaynllrofk7ZcYccM","type":"ellipse","x":33.125831604003906,"y":-127.07732391357422,"width":69.37811279296875,"height":67.187255859375,"angle":0,"strokeColor":"#d9480f","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":2},"seed":1274526725,"version":41,"versionNonce":348323659,"isDeleted":false,"boundElements":null,"updated":1682764465874,"link":null,"locked":false},{"id":"VBXXrIA3","type":"text","x":255.1359634399414,"y":-168.21038055419922,"width":166,"height":25,"angle":0,"strokeColor":"#d9480f","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":null,"seed":1281863397,"version":128,"versionNonce":640028811,"isDeleted":false,"boundElements":null,"updated":1682764486458,"link":null,"locked":false,"text":"Probabilità che si verifichi quella\ndeterminata congiuntura economica","rawText":"Probabilità che si verifichi quella\ndeterminata congiuntura economica","fontSize":9.664806343658624,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":21,"containerId":null,"originalText":"Probabilità che si verifichi quella\ndeterminata congiuntura economica"},{"type":"text","version":281,"versionNonce":1825686821,"isDeleted":false,"id":"BwtUhIwZ","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":254.94986724853516,"y":-131.2437810618975,"strokeColor":"#364fc7","backgroundColor":"transparent","width":257,"height":25,"seed":1130975653,"groupIds":[],"roundness":null,"boundElements":null,"updated":1682764653465,"link":null,"locked":false,"fontSize":9.664806343658624,"fontFamily":1,"text":"Probabilità data dalle distribuzioni condizionate \n(vengono dai prodotti per l'assunzione di indipendenza)","rawText":"Probabilità data dalle distribuzioni condizionate \n(vengono dai prodotti per l'assunzione di indipendenza)","baseline":21,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Probabilità data dalle distribuzioni condizionate \n(vengono dai prodotti per l'assunzione di indipendenza)"},{"id":"3TWqDXlRNqumi9D4II6mN","type":"rectangle","x":19.250160217285156,"y":-137.30150604248047,"width":229.31317138671875,"height":93.47799682617188,"angle":0,"strokeColor":"#5c940d","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":1795676293,"version":45,"versionNonce":753026757,"isDeleted":false,"boundElements":null,"updated":1682764666593,"link":null,"locked":false},{"type":"text","version":330,"versionNonce":1557381605,"isDeleted":false,"id":"VfK9EXbc","fillStyle":"hachure","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":261.6407241821289,"y":-90.62950897216797,"strokeColor":"#5c940d","backgroundColor":"transparent","width":41,"height":12,"seed":81208869,"groupIds":[],"roundness":null,"boundElements":null,"updated":1682764675894,"link":null,"locked":false,"fontSize":9.664806343658624,"fontFamily":1,"text":"Miscuglio","rawText":"Miscuglio","baseline":9,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Miscuglio"}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#5c940d","currentItemBackgroundColor":"transparent","currentItemFillStyle":"hachure","currentItemStrokeWidth":2,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":667.0918579101562,"scrollY":312.6297607421875,"zoom":{"value":1},"currentItemRoundness":"round","gridSize":null,"colorPalette":{}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Variabile_casuale_somma_2023-04-29_1234.00.excalidraw.md5");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>
Introducendo il miscuglio, ricordando le passate lezioni, l'indipendenza supposta si perde e abbiamo la dipendenza tra le variabili.

La banca più che alla distribuzione congiunta delle varie $X$ è interessata alla distribuzione della loro somma $S$, ovvero qil numero totale di default che si realizzano tra i 3 soggetti.